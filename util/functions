#!/bin/bash
# shellcheck disable=SC2207 # Arrays are a pain in bash 3

echo "functions assume they are run from repo root"
echo "run \"list\" for a list of helpers"

INIT_LOCATION="$0"

## External

build() {
    echo "Building the extension..."
    npm run compile
}

install_deps() {
    echo "Installing dependencies..."
    npm install
}

package() {
    echo "Packaging the extension..."
    vsce package
}

install() {
    echo "Installing the extension..."
    code --install-extension strikethrough-toggle-*.vsix
}

uninstall() {
    echo "Uninstalling the extension..."
    code --uninstall-extension adamgordonbell.strikethrough-toggle
}

dev() {
    echo "Starting development environment..."
    code .
}

test() {
    echo "Running tests..."
    npm test
}

clean() {
    echo "Cleaning build artifacts..."
    rm -rf out
    rm -f *.vsix
}

publish() {
    echo "Publishing the extension..."
    vsce publish
}

list() {
    echo "Available functions:"
    declare -F | awk '{print $3}' | grep -v '^_'
}

# Run the function passed as argument
if [[ $# -gt 0 ]]; then
    "$@"
else
    echo "No function specified. Use 'list' to see available functions."
fi
